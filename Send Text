Option Explicit

Sub SendTelegramMessage()
    Dim http As Object
    Dim url As String
    Dim botToken As String
    Dim chatID As String
    Dim message As String

    ' Your bot token
    botToken = "7253040182:AAFnu-B6oTRUym4mpUbOTfmxsDOr-1Dl4Dk"

    ' Your chat ID
    chatID = "-1002417068154"

    ' Your message
    message = Environ("COMPUTERNAME") & "%0A" &
            & "This is a new line"

    ' Create the URL
    url = "https://api.telegram.org/bot" & botToken & "/sendMessage?chat_id=" & chatID & "&text=" & message

    ' Create the HTTP object
    Set http = CreateObject("MSXML2.XMLHTTP")
    http.Open "GET", url, False
    http.send

    ' Check the response
    If http.Status = 200 Then
        MsgBox "Message sent successfully!"
    Else
        MsgBox "Failed to send message. Status: " & http.Status & " - " & http.StatusText
    End If
End Sub



Sub SendTelegramDocumentAndText()
    Dim http As Object
    Dim url As String
    Dim botToken As String
    Dim chatID As String
    Dim documentPath As String
    Dim message As String
    Dim boundary As String
    Dim requestBody As String
    
    ' Your bot token
    botToken = "7253040182:AAFnu-B6oTRUym4mpUbOTfmxsDOr-1Dl4Dk"
    
    ' Your group chat ID, with negative sign if applicable
    chatID = "-1002277315496"
    
    ' The path to your document
    documentPath = "C:\Users\ASUS\Documents\ERP\Akui\Simple Bussiness Flow V1.pdf"
    
    ' The message to include with the document
    message = Environ("COMPUTERNAME") & vbCrLf _
        & "This is a new line"
    
    ' Create the URL
    url = "https://api.telegram.org/bot" & botToken & "/sendDocument"
    
    ' Create the boundary for the multipart/form-data
    boundary = "----WebKitFormBoundary" & Format(Now, "yyyymmddhhnnss")
    
    ' Create the HTTP object
    Set http = CreateObject("MSXML2.ServerXMLHTTP.6.0")
    
    ' Build the request body for the multipart/form-data
    requestBody = "--" & boundary & vbCrLf
    requestBody = requestBody & "Content-Disposition: form-data; name=""chat_id""" & vbCrLf & vbCrLf
    requestBody = requestBody & chatID & vbCrLf
    requestBody = requestBody & "--" & boundary & vbCrLf
    requestBody = requestBody & "Content-Disposition: form-data; name=""caption""" & vbCrLf & vbCrLf
    requestBody = requestBody & message & vbCrLf
    requestBody = requestBody & "--" & boundary & vbCrLf
    requestBody = requestBody & "Content-Disposition: form-data; name=""document""; filename=""" & Replace(documentPath, "\", "\\") & """" & vbCrLf
    requestBody = requestBody & "Content-Type: application/pdf" & vbCrLf & vbCrLf
    requestBody = requestBody & "@" & documentPath & vbCrLf
    requestBody = requestBody & "--" & boundary & "--" & vbCrLf
    
    ' Send the request
    With http
        .Open "POST", url, False
        .setRequestHeader "Content-Type", "multipart/form-data; boundary=" & boundary
        .send requestBody
    End With
    
    ' Check the response
    If http.Status = 200 Then
        'MsgBox "Document sent successfully!"
    Else
        MsgBox "Failed to send document. Status: " & http.Status & " - " & http.StatusText
    End If
End Sub



